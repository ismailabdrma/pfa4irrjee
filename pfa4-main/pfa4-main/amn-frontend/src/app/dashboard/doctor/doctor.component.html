<div class="doctor-dashboard container-fluid p-4">
  <!-- Header Section -->
  <div class="dashboard-header mb-4">
    <div class="header-content">
      <h2 class="mb-1">Tableau de Bord Médical</h2>
      <h3 class="doctor-name">Bienvenue, Dr. {{ doctorName }}</h3>
    </div>
  </div>

  <!-- Patient Search Card -->
  <div class="card search-card mb-4 shadow-sm">
    <div class="card-header">
      <h3 class="card-title mb-0">
        <i class="fas fa-search me-2"></i>Recherche du Patient
      </h3>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-6">
          <div class="form-group mb-3">
            <label for="cinInput" class="form-label">CIN</label>
            <input type="text" id="cinInput" class="form-control" [(ngModel)]="cin" placeholder="Numéro CIN">
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group mb-3">
            <label for="fullNameInput" class="form-label">Nom Complet</label>
            <input type="text" id="fullNameInput" class="form-control" [(ngModel)]="fullName" placeholder="Nom et Prénom">
          </div>
        </div>
      </div>
      <button class="btn btn-search w-100" (click)="searchPatient()">
        <i class="fas fa-search me-2"></i>Rechercher
      </button>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-container text-center py-5">
    <div class="spinner-wrapper">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <div class="spinner-glow"></div>
    </div>
    <p class="mt-4 loading-text">Chargement en cours...</p>
  </div>

  <!-- Patient Profile and Medical Information (Only shown after search) -->
  <div *ngIf="patientProfile && !isLoading" class="row mt-4 g-4">
    <!-- Left Column - Patient Profile -->
    <div class="col-md-4">
      <div class="card patient-card shadow-sm h-100">
        <div class="card-header">
          <h3 class="card-title mb-0">
            <i class="fas fa-user-circle me-2"></i>Profil du Patient
          </h3>
        </div>
        <div class="card-body">
          <div class="patient-avatar mb-3 text-center">
            <div class="avatar-circle">
              <span class="avatar-initials">{{ patientProfile.fullName?.charAt(0) || 'P' }}</span>
            </div>
          </div>

          <div class="patient-info">
            <div class="info-item">
              <div class="info-icon"><i class="fas fa-id-card"></i></div>
              <div class="info-content">
                <div class="info-label">CIN</div>
                <div class="info-value">{{ patientProfile.cin }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-user"></i></div>
              <div class="info-content">
                <div class="info-label">Nom</div>
                <div class="info-value">{{ patientProfile.fullName }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-birthday-cake"></i></div>
              <div class="info-content">
                <div class="info-label">Date de naissance</div>
                <div class="info-value">{{ patientProfile.birthDate | date }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-tint"></i></div>
              <div class="info-content">
                <div class="info-label">Groupe sanguin</div>
                <div class="info-value">{{ patientProfile.bloodType || 'Non spécifié' }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-envelope"></i></div>
              <div class="info-content">
                <div class="info-label">Email</div>
                <div class="info-value">{{ patientProfile.email || 'Non spécifié' }}</div>
              </div>
            </div>
          </div>

          <div class="medical-info mt-4">
            <h4 class="section-title">Informations Médicales</h4>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-allergies"></i></div>
              <div class="info-content">
                <div class="info-label">Allergies</div>
                <div class="info-value">{{ patientProfile.allergies || 'Aucune connue' }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-heartbeat"></i></div>
              <div class="info-content">
                <div class="info-label">Maladies chroniques</div>
                <div class="info-value">{{ patientProfile.chronicDiseases || 'Aucune connue' }}</div>
              </div>
            </div>

            <div class="info-item">
              <div class="info-icon"><i class="fas fa-phone-alt"></i></div>
              <div class="info-content">
                <div class="info-label">Contact d'urgence</div>
                <div class="info-value">{{ patientProfile.emergencyContact || 'Non spécifié' }}</div>
              </div>
            </div>
          </div>

          <button class="btn btn-consultation w-100 mt-4" (click)="navigateToConsultation()">
            <i class="fas fa-file-medical me-2"></i>Nouvelle Consultation
          </button>
        </div>
      </div>
    </div>

    <!-- Middle Column - Medical History -->
    <div class="col-md-4">
      <div class="card history-card shadow-sm h-100">
        <div class="card-header">
          <h3 class="card-title mb-0">
            <i class="fas fa-history me-2"></i>Historique Médical
          </h3>
        </div>
        <div class="card-body history-body">
          <div *ngIf="patientProfile?.medicalRecords?.length; else noRecords">
            <div *ngFor="let record of patientProfile.medicalRecords" class="record-item mb-3">
              <div class="record-header">
                <h5 class="record-title">{{ record.reason }}</h5>
                <span class="record-date">{{ record.creationDate | date:'mediumDate' }}</span>
              </div>

              <div class="record-content">
                <p class="record-diagnosis"><strong>Diagnostic:</strong> {{ record.diagnosis || 'Non spécifié' }}</p>
                <p class="record-notes"><strong>Notes:</strong> {{ record.notes || 'Aucune note' }}</p>
              </div>

              <div class="record-actions">
                <button class="btn btn-view" (click)="viewConsultationDetails(record.id)">
                  <i class="fas fa-eye me-1"></i>Détails
                </button>
              </div>

              <!-- Prescriptions -->
              <div *ngIf="record.prescriptions?.length" class="record-prescriptions">
                <h6 class="prescriptions-title">Ordonnances</h6>
                <div *ngFor="let prescription of record.prescriptions" class="prescription-item">
                  <div class="prescription-header">
                    <span class="prescription-date">{{ prescription.prescribedDate | date:'shortDate' }}</span>
                    <button class="btn btn-prescription" (click)="viewPrescriptionDetails(prescription.id)">
                      <i class="fas fa-file-prescription"></i>
                    </button>
                  </div>

                  <ul class="medications-list">
                    <li *ngFor="let med of prescription.medications" class="medication">
                      {{ med.name }} - {{ med.dosage }} ({{ med.period }})
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <ng-template #noRecords>
            <div class="empty-state">
              <i class="fas fa-file-medical-alt empty-icon"></i>
              <p class="empty-message">Aucune consultation trouvée</p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>

    <!-- Right Column - Actions -->
    <div class="col-md-4">
      <div class="card actions-card shadow-sm">
        <div class="card-header">
          <h3 class="card-title mb-0">
            <i class="fas fa-plus-circle me-2"></i>Ajouter des Données Médicales
          </h3>
        </div>
        <div class="card-body">
          <button class="btn btn-action mb-3" (click)="navigateToConsultation()" [disabled]="!patientProfile">
            <i class="fas fa-file-medical me-2"></i>Nouvelle Consultation
          </button>

          <!-- Medical Data Type Selector -->
          <div class="form-group mb-3">
            <label for="medicalDataType" class="form-label">Type de donnée médicale</label>
            <select id="medicalDataType" class="form-control" [(ngModel)]="activeUploadTab">
              <option value="scans">Imagerie Médicale</option>
              <option value="analyses">Analyse Médicale</option>
              <option value="surgeries">Chirurgie</option>
              <option value="vaccinations">Vaccination</option>
            </select>
          </div>

          <!-- Medical Data Forms -->
          <div class="medical-data-form p-3 border rounded">
            <!-- Scans Form -->
            <div *ngIf="activeUploadTab === 'scans'">
              <h5 class="form-section-title">Ajouter un Scan Médical</h5>
              <div class="mb-2">
                <label class="form-label">Fichier<span class="required-asterisk">*</span></label>
                <input type="file" id="scanFileInput" class="form-control" (change)="onScanFileChange($event)" accept=".pdf,.jpg,.png">
              </div>
              <div class="mb-2">
                <label class="form-label">Titre<span class="required-asterisk">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="scanPayload.title" name="scanTitle" placeholder="Titre du scan">
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" [(ngModel)]="scanPayload.description" name="scanDesc" rows="2" placeholder="Description du scan"></textarea>
              </div>
              <button class="btn btn-upload w-100" (click)="uploadScan()" [disabled]="!scanFile">
                <i class="fas fa-upload me-1"></i>Téléverser Scan
              </button>
            </div>

            <!-- Analyses Form -->
            <div *ngIf="activeUploadTab === 'analyses'">
              <h5 class="form-section-title">Ajouter une Analyse Médicale</h5>
              <div class="mb-2">
                <label class="form-label">Fichier<span class="required-asterisk">*</span></label>
                <input type="file" id="analysisFileInput" class="form-control" (change)="onAnalysisFileChange($event)" accept=".pdf,.jpg,.png">
              </div>
              <div class="mb-2">
                <label class="form-label">Titre<span class="required-asterisk">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="analysisPayload.title" name="analysisTitle" placeholder="Titre de l'analyse">
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" [(ngModel)]="analysisPayload.description" name="analysisDesc" rows="2" placeholder="Description de l'analyse"></textarea>
              </div>
              <button class="btn btn-upload w-100" (click)="uploadAnalysis()" [disabled]="!analysisFile">
                <i class="fas fa-upload me-1"></i>Téléverser Analyse
              </button>
            </div>

            <!-- Surgeries Form -->
            <div *ngIf="activeUploadTab === 'surgeries'">
              <h5 class="form-section-title">Ajouter un Rapport de Chirurgie</h5>
              <div class="mb-2">
                <label class="form-label">Fichier<span class="required-asterisk">*</span></label>
                <input type="file" id="surgeryFileInput" class="form-control" (change)="onSurgeryFileChange($event)" accept=".pdf,.jpg,.png">
              </div>
              <div class="mb-2">
                <label class="form-label">Titre<span class="required-asterisk">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="surgeryPayload.title" name="surgeryTitle" placeholder="Titre du rapport">
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" [(ngModel)]="surgeryPayload.description" name="surgeryDesc" rows="2" placeholder="Description de la chirurgie"></textarea>
              </div>
              <button class="btn btn-upload w-100" (click)="uploadSurgery()" [disabled]="!surgeryFile">
                <i class="fas fa-upload me-1"></i>Téléverser Rapport
              </button>
            </div>

            <!-- Vaccinations Form -->
            <div *ngIf="activeUploadTab === 'vaccinations'">
              <h5 class="form-section-title">Ajouter une Vaccination</h5>
              <div class="mb-2">
                <label class="form-label">Nom du vaccin<span class="required-asterisk">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="vaccination.vaccineName" placeholder="Ex: Pfizer COVID-19, BCG, Hépatite B...">
              </div>
              <div class="mb-2">
                <label class="form-label">Numéro de dose<span class="required-asterisk">*</span></label>
                <input type="number" class="form-control" [(ngModel)]="vaccination.doseNumber" min="1" value="1">
              </div>
              <div class="mb-2">
                <label class="form-label">Fabricant<span class="required-asterisk">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="vaccination.manufacturer" placeholder="Ex: Pfizer, Moderna, Sanofi...">
              </div>
              <div class="mb-3">
                <label class="form-label">Date<span class="required-asterisk">*</span></label>
                <input type="date" class="form-control" [(ngModel)]="vaccination.date">
              </div>
              <button class="btn btn-upload w-100" (click)="addVaccination()">
                <i class="fas fa-syringe me-2"></i>Enregistrer Vaccination
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  <!-- Medical Files Display Section -->
  <div class="card documents-card shadow-sm mt-4" *ngIf="patientProfile && !isLoading">
    <div class="card-header">
      <h3 class="card-title mb-0">
        <i class="fas fa-folder-open me-2"></i>Documents Médicaux
      </h3>
    </div>

    <div class="card-body">
      <!-- Tabs for different document types -->
      <ul class="nav nav-tabs documents-tabs" id="medicalDocTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link" [class.active]="activeDocTab === 'scans'" id="scans-tab" data-bs-toggle="tab" data-bs-target="#scans" type="button" role="tab" (click)="setActiveDocTab('scans')">
            <i class="fas fa-x-ray me-2"></i>Imageries <span class="doc-count">{{ patientProfile.scans?.length || 0 }}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" [class.active]="activeDocTab === 'analyses'" id="analyses-tab" data-bs-toggle="tab" data-bs-target="#analyses" type="button" role="tab" (click)="setActiveDocTab('analyses')">
            <i class="fas fa-vial me-2"></i>Analyses <span class="doc-count">{{ patientProfile.analyses?.length || 0 }}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" [class.active]="activeDocTab === 'surgeries'" id="surgeries-tab" data-bs-toggle="tab" data-bs-target="#surgeries" type="button" role="tab" (click)="setActiveDocTab('surgeries')">
            <i class="fas fa-procedures me-2"></i>Chirurgies <span class="doc-count">{{ patientProfile.surgeries?.length || 0 }}</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" [class.active]="activeDocTab === 'vaccinations'" id="vaccinations-tab" data-bs-toggle="tab" data-bs-target="#vaccinations" type="button" role="tab" (click)="setActiveDocTab('vaccinations')">
            <i class="fas fa-syringe me-2"></i>Vaccinations <span class="doc-count">{{ patientProfile.vaccinations?.length || 0 }}</span>
          </button>
        </li>
      </ul>

      <!-- Tab content -->
      <div class="tab-content pt-4" id="medicalDocContent">
        <!-- Scans Tab -->
        <div class="tab-pane fade" [class.show]="activeDocTab === 'scans'" [class.active]="activeDocTab === 'scans'" id="scans" role="tabpanel">
          <div *ngIf="patientProfile.scans?.length; else noScans">
            <div class="row g-3">
              <div class="col-md-6 col-lg-4" *ngFor="let scan of patientProfile.scans">
                <div class="document-card">
                  <div class="document-header">
                    <div class="document-icon">
                      <i class="fas fa-x-ray"></i>
                    </div>
                    <div class="document-info">
                      <h5 class="document-title">{{ scan.title }}</h5>
                      <span class="document-date">{{ scan.uploadDate | date }}</span>
                    </div>
                  </div>
                  <div class="document-body">
                    <p class="document-description">{{ scan.description }}</p>
                    <button class="btn btn-view-document" (click)="openFile(scan.url)">
                      <i class="fas fa-file-medical me-1"></i>Voir le document
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noScans>
            <div class="empty-state">
              <i class="fas fa-x-ray empty-icon"></i>
              <p class="empty-message">Aucune image médicale trouvée pour ce patient</p>
            </div>
          </ng-template>
        </div>

        <!-- Analyses Tab -->
        <div class="tab-pane fade" [class.show]="activeDocTab === 'analyses'" [class.active]="activeDocTab === 'analyses'" id="analyses" role="tabpanel">
          <div *ngIf="patientProfile.analyses?.length; else noAnalyses">
            <div class="row g-3">
              <div class="col-md-6 col-lg-4" *ngFor="let analysis of patientProfile.analyses">
                <div class="document-card">
                  <div class="document-header">
                    <div class="document-icon analysis-icon">
                      <i class="fas fa-vial"></i>
                    </div>
                    <div class="document-info">
                      <h5 class="document-title">{{ analysis.title }}</h5>
                      <span class="document-date">{{ analysis.uploadDate | date }}</span>
                    </div>
                  </div>
                  <div class="document-body">
                    <p class="document-description">{{ analysis.description }}</p>
                    <button class="btn btn-view-document" (click)="openFile(analysis.url)">
                      <i class="fas fa-file-alt me-1"></i>Voir le rapport
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noAnalyses>
            <div class="empty-state">
              <i class="fas fa-vial empty-icon"></i>
              <p class="empty-message">Aucune analyse trouvée pour ce patient</p>
            </div>
          </ng-template>
        </div>

        <!-- Surgeries Tab -->
        <div class="tab-pane fade" [class.show]="activeDocTab === 'surgeries'" [class.active]="activeDocTab === 'surgeries'" id="surgeries" role="tabpanel">
          <div *ngIf="patientProfile.surgeries?.length; else noSurgeries">
            <div class="row g-3">
              <div class="col-md-6 col-lg-4" *ngFor="let surgery of patientProfile.surgeries">
                <div class="document-card">
                  <div class="document-header">
                    <div class="document-icon surgery-icon">
                      <i class="fas fa-procedures"></i>
                    </div>
                    <div class="document-info">
                      <h5 class="document-title">{{ surgery.title }}</h5>
                      <span class="document-date">{{ surgery.uploadDate | date }}</span>
                    </div>
                  </div>
                  <div class="document-body">
                    <p class="document-description">{{ surgery.description }}</p>
                    <button class="btn btn-view-document" (click)="openFile(surgery.url)">
                      <i class="fas fa-file-medical-alt me-1"></i>Voir le rapport
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noSurgeries>
            <div class="empty-state">
              <i class="fas fa-procedures empty-icon"></i>
              <p class="empty-message">Aucun rapport de chirurgie trouvé pour ce patient</p>
            </div>
          </ng-template>
        </div>

        <!-- Vaccinations Tab -->
        <div class="tab-pane fade" [class.show]="activeDocTab === 'vaccinations'" [class.active]="activeDocTab === 'vaccinations'" id="vaccinations" role="tabpanel">
          <div *ngIf="patientProfile.vaccinations?.length; else noVaccinations">
            <div class="vaccinations-table">
              <table class="table">
                <thead>
                <tr>
                  <th>Vaccin</th>
                  <th>Dose</th>
                  <th>Fabricant</th>
                  <th>Date</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let vax of patientProfile.vaccinations">
                  <td><span class="vaccine-name">{{ vax.vaccineName }}</span></td>
                  <td>{{ vax.doseNumber }}</td>
                  <td>{{ vax.manufacturer }}</td>
                  <td>{{ vax.vaccinationDate | date }}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <ng-template #noVaccinations>
            <div class="empty-state">
              <i class="fas fa-syringe empty-icon"></i>
              <p class="empty-message">Aucun vaccin enregistré pour ce patient</p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<style>
  /* Base styles */
  :root {
    --primary-color: #2563eb;
    --primary-light: #dbeafe;
    --primary-dark: #1d4ed8;
    --success-color: #10b981;
    --success-light: #d1fae5;
    --info-color: #0ea5e9;
    --info-light: #e0f2fe;
    --warning-color: #f59e0b;
    --warning-light: #fef3c7;
    --danger-color: #ef4444;
    --danger-light: #fee2e2;
    --secondary-color: #6b7280;
    --secondary-light: #f3f4f6;
    --text-dark: #1f2937;
    --text-light: #6b7280;
    --border-color: #e5e7eb;
    --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }

  /* Main container */
  .doctor-dashboard {
    max-width: 1400px;
    margin: 0 auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: var(--text-dark);
  }

  /* Header */
  .dashboard-header {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
    border-radius: 0.75rem;
    padding: 1.5rem;
    box-shadow: var(--card-shadow);
    position: relative;
    overflow: hidden;
  }

  .dashboard-header::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="rgba(255,255,255,0.05)" d="M0 0h100v100H0z"/><path fill="rgba(255,255,255,0.05)" d="M0 0h50v50H0zM50 50h50v50H50z"/></svg>');
    opacity: 0.3;
  }

  .header-content {
    position: relative;
    z-index: 1;
  }

  .dashboard-header h2 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .doctor-name {
    font-size: 1.25rem;
    font-weight: 500;
    opacity: 0.9;
  }

  /* Cards */
  .card {
    border: none;
    border-radius: 0.75rem;
    overflow: hidden;
    box-shadow: var(--card-shadow);
    transition: box-shadow 0.3s ease;
    margin-bottom: 1.5rem;
    background-color: white;
  }

  .card:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  .card-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border-color);
  }

  .search-card .card-header {
    background-color: var(--info-light);
    color: var(--info-color);
  }

  .patient-card .card-header {
    background-color: var(--success-light);
    color: var(--success-color);
  }

  .history-card .card-header {
    background-color: var(--secondary-light);
    color: var(--secondary-color);
  }

  .actions-card .card-header {
    background-color: var(--primary-light);
    color: var(--primary-color);
  }

  .documents-card .card-header {
    background-color: var(--warning-light);
    color: var(--warning-color);
  }

  .card-title {
    font-size: 1.25rem;
    font-weight: 600;
    display: flex;
    align-items: center;
  }

  .card-body {
    padding: 1.5rem;
  }

  /* Patient avatar */
  .avatar-circle {
    width: 80px;
    height: 80px;
    background-color: var(--primary-light);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
  }

  .avatar-initials {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary-color);
  }

  /* Patient info */
  .patient-info, .medical-info {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .info-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
  }

  .info-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-color);
  }

  .info-content {
    flex: 1;
  }

  .info-label {
    font-size: 0.75rem;
    color: var(--text-light);
    margin-bottom: 0.125rem;
  }

  .info-value {
    font-weight: 500;
    color: var(--text-dark);
  }

  .section-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-dark);
  }

  /* Medical history */
  .history-body {
    max-height: 600px;
    overflow-y: auto;
  }

  .record-item {
    background-color: white;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-bottom: 1rem;
    border: 1px solid var(--border-color);
    transition: all 0.2s ease;
  }

  .record-item:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    transform: translateY(-2px);
  }

  .record-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
  }

  .record-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--primary-color);
    margin: 0;
  }

  .record-date {
    font-size: 0.75rem;
    color: var(--text-light);
  }

  .record-content {
    margin-bottom: 0.75rem;
  }

  .record-diagnosis, .record-notes {
    margin-bottom: 0.25rem;
    font-size: 0.875rem;
  }

  .record-actions {
    display: flex;
    gap: 0.5rem;
  }

  .record-prescriptions {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px dashed var(--border-color);
  }

  .prescriptions-title {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
  }

  .prescription-item {
    background-color: var(--primary-light);
    border-radius: 0.375rem;
    padding: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .prescription-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .prescription-date {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--primary-color);
  }

  .medications-list {
    list-style-type: disc;
    padding-left: 1.5rem;
    margin: 0;
  }

  .medication {
    font-size: 0.75rem;
    margin-bottom: 0.25rem;
  }

  /* Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.625rem 1.25rem;
    font-weight: 500;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    border: none;
    cursor: pointer;
  }

  .btn-search {
    background-color: var(--info-color);
    color: white;
  }

  .btn-search:hover {
    background-color: #0284c7;
  }

  .btn-consultation {
    background-color: var(--success-color);
    color: white;
  }

  .btn-consultation:hover {
    background-color: #059669;
  }

  .btn-view {
    padding: 0.375rem 0.75rem;
    font-size: 0.75rem;
    background-color: var(--primary-light);
    color: var(--primary-color);
  }

  .btn-view:hover {
    background-color: #bfdbfe;
  }

  .btn-prescription {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    background-color: white;
    color: var(--info-color);
    border: 1px solid var(--info-color);
  }

  .btn-prescription:hover {
    background-color: var(--info-light);
  }

  .btn-action {
    background-color: var(--primary-color);
    color: white;
    width: 100%;
    text-align: left;
    justify-content: flex-start;
  }

  .btn-action:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
  }

  .btn-action:disabled {
    background-color: var(--secondary-light);
    color: var(--secondary-color);
    cursor: not-allowed;
    transform: none;
  }

  .btn-upload {
    background-color: var(--primary-color);
    color: white;
  }

  .btn-upload:hover {
    background-color: var(--primary-dark);
  }

  .btn-upload:disabled {
    background-color: var(--secondary-light);
    color: var(--secondary-color);
    cursor: not-allowed;
  }

  .btn-view-document {
    padding: 0.375rem 0.75rem;
    font-size: 0.75rem;
    background-color: var(--primary-light);
    color: var(--primary-color);
  }

  .btn-view-document:hover {
    background-color: #bfdbfe;
  }

  /* Tabs */
  .nav-tabs {
    border-bottom: 1px solid var(--border-color);
  }

  .medical-tabs {
    margin-bottom: 0;
  }

  .nav-tabs .nav-link {
    color: var(--text-light);
    border: none;
    padding: 0.75rem 1rem;
    font-weight: 500;
    border-radius: 0;
    transition: all 0.2s ease;
  }

  .nav-tabs .nav-link:hover {
    color: var(--primary-color);
    background-color: var(--primary-light);
    border-color: transparent;
  }

  .nav-tabs .nav-link.active {
    color: var(--primary-color);
    background-color: white;
    border-bottom: 2px solid var(--primary-color);
    font-weight: 600;
  }

  .documents-tabs .nav-link {
    display: flex;
    align-items: center;
  }

  .doc-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 20px;
    padding: 0 6px;
    font-size: 0.75rem;
    font-weight: 600;
    background-color: var(--primary-light);
    color: var(--primary-color);
    border-radius: 9999px;
    margin-left: 0.5rem;
  }

  /* Form elements */
  .form-label {
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.375rem;
    display: block;
  }

  .required-asterisk {
    color: var(--danger-color);
    margin-left: 0.25rem;
  }

  .form-control {
    width: 100%;
    padding: 0.625rem 0.875rem;
    font-size: 0.875rem;
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    transition: all 0.2s ease;
  }

  .form-control:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    outline: none;
  }

  textarea.form-control {
    min-height: 80px;
    resize: vertical;
  }

  .form-section-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--text-dark);
  }

  /* Document cards */
  .document-card {
    background-color: white;
    border-radius: 0.5rem;
    border: 1px solid var(--border-color);
    overflow: hidden;
    transition: all 0.2s ease;
    height: 100%;
  }

  .document-card:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }

  .document-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    border-bottom: 1px solid var(--border-color);
  }

  .document-icon {
    width: 40px;
    height: 40px;
    border-radius: 0.375rem;
    background-color: var(--primary-light);
    color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
  }

  .analysis-icon {
    background-color: var(--info-light);
    color: var(--info-color);
  }

  .surgery-icon {
    background-color: var(--warning-light);
    color: var(--warning-color);
  }

  .document-info {
    flex: 1;
  }

  .document-title {
    font-size: 0.875rem;
    font-weight: 600;
    margin: 0 0 0.25rem;
    color: var(--text-dark);
  }

  .document-date {
    font-size: 0.75rem;
    color: var(--text-light);
  }

  .document-body {
    padding: 1rem;
  }

  .document-description {
    font-size: 0.875rem;
    color: var(--text-light);
    margin-bottom: 1rem;
    min-height: 40px;
  }

  /* Vaccinations table */
  .vaccinations-table {
    overflow-x: auto;
  }

  .table {
    width: 100%;
    border-collapse: collapse;
  }

  .table th {
    background-color: var(--secondary-light);
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-color);
  }

  .table td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-dark);
  }

  .table tr:hover {
    background-color: var(--secondary-light);
  }

  .vaccine-name {
    font-weight: 600;
    color: var(--primary-color);
  }

  /* Empty states */
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem 1rem;
    color: var(--text-light);
  }

  .empty-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
  }

  .empty-message {
    font-size: 1rem;
    text-align: center;
  }

  /* Loading state */
  .loading-container {
    padding: 3rem 0;
  }

  .spinner-wrapper {
    position: relative;
    width: 4rem;
    height: 4rem;
    margin: 0 auto;
  }

  .spinner-border {
    width: 4rem;
    height: 4rem;
    border-width: 0.3rem;
    color: var(--primary-color);
  }

  .spinner-glow {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: rgba(37, 99, 235, 0.2);
    animation: pulse 1.5s ease-in-out infinite;
  }

  .loading-text {
    font-size: 1.125rem;
    color: var(--text-light);
    font-weight: 500;
  }

  @keyframes pulse {
    0% { transform: scale(0.8); opacity: 0.8; }
    50% { transform: scale(1.2); opacity: 0.4; }
    100% { transform: scale(0.8); opacity: 0.8; }
  }

  /* Utility classes */
  .me-1 {
    margin-right: 0.25rem;
  }

  .me-2 {
    margin-right: 0.5rem;
  }

  .mb-1 {
    margin-bottom: 0.25rem;
  }

  .mb-2 {
    margin-bottom: 0.5rem;
  }

  .mb-3 {
    margin-bottom: 0.75rem;
  }

  .mb-4 {
    margin-bottom: 1rem;
  }

  .mt-1 {
    margin-top: 0.25rem;
  }

  .mt-2 {
    margin-top: 0.5rem;
  }

  .mt-3 {
    margin-top: 0.75rem;
  }

  .mt-4 {
    margin-top: 1rem;
  }

  .g-3 {
    --bs-gutter-x: 1rem;
    --bs-gutter-y: 1rem;
  }

  .g-4 {
    --bs-gutter-x: 1.5rem;
    --bs-gutter-y: 1.5rem;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .dashboard-header {
      padding: 1.25rem;
    }

    .card-body {
      padding: 1.25rem;
    }

    .nav-tabs .nav-link {
      padding: 0.5rem 0.75rem;
      font-size: 0.875rem;
    }

    .document-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .document-icon {
      width: 32px;
      height: 32px;
      font-size: 1rem;
    }
  }

  @media (max-width: 576px) {
    .dashboard-header h2 {
      font-size: 1.5rem;
    }

    .doctor-name {
      font-size: 1.125rem;
    }

    .card-title {
      font-size: 1.125rem;
    }

    .btn {
      padding: 0.5rem 1rem;
    }
  }

  /* Tab animations */
  .tab-pane.fade {
    opacity: 0;
    transition: opacity 0.15s linear;
  }

  .tab-pane.fade.show {
    opacity: 1;
  }

  .tab-pane.fade.show.active {
    animation: fadeIn 0.3s;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Custom tab system */
  .medical-data-tabs {
    display: flex;
    border-bottom: 1px solid var(--border-color);
    overflow-x: auto;
    white-space: nowrap;
  }

  .tab-button {
    padding: 0.75rem 1rem;
    background: none;
    border: none;
    color: var(--text-light);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
  }

  .tab-button:hover {
    color: var(--primary-color);
    background-color: var(--primary-light);
  }

  .tab-button.active {
    color: var(--primary-color);
    font-weight: 600;
  }

  .tab-button.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background-color: var(--primary-color);
  }

  .tab-content-container {
    background-color: white;
    min-height: 300px;
  }

  .tab-content {
    animation: fadeIn 0.3s;
  }
</style>

<script>
  // Initialize Bootstrap tabs
  document.addEventListener('DOMContentLoaded', function() {
    // For the medical data tabs
    const medicalTabTriggerList = [].slice.call(document.querySelectorAll('#medicalDataTabs button'));
    medicalTabTriggerList.forEach(function(tabTriggerEl) {
      tabTriggerEl.addEventListener('click', function(event) {
        event.preventDefault();
        const tabTarget = document.querySelector(this.getAttribute('data-bs-target'));

        // Hide all tab panes
        document.querySelectorAll('.tab-pane').forEach(function(pane) {
          pane.classList.remove('show', 'active');
        });

        // Deactivate all tabs
        document.querySelectorAll('#medicalDataTabs .nav-link').forEach(function(tab) {
          tab.classList.remove('active');
          tab.setAttribute('aria-selected', 'false');
        });

        // Activate the clicked tab
        this.classList.add('active');
        this.setAttribute('aria-selected', 'true');

        // Show the target tab pane
        if (tabTarget) {
          tabTarget.classList.add('show', 'active');
        }
      });
    });

    // For the document tabs
    const docTabTriggerList = [].slice.call(document.querySelectorAll('#medicalDocTabs button'));
    docTabTriggerList.forEach(function(tabTriggerEl) {
      tabTriggerEl.addEventListener('click', function(event) {
        // The Angular component handles this with setActiveDocTab()
        // This is just to ensure the UI updates correctly
        document.querySelectorAll('#medicalDocTabs .nav-link').forEach(function(tab) {
          tab.classList.remove('active');
          tab.setAttribute('aria-selected', 'false');
        });

        this.classList.add('active');
        this.setAttribute('aria-selected', 'true');
      });
    });
  });
</script>
